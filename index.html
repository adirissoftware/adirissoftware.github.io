<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="./libs/aframe.min.js"></script>
    <script src="./libs/mindar-image-aframe.prod.js"></script>
    
    <style>
        /* 1. ESTILOS DE LA PANTALLA DE CARGA */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #1a1a1a;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.8s ease;
            color: white;
            font-family: sans-serif;
            text-align: center;
        }

        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-left-color: #FFD700;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* 2. ESTILOS DE LA TARJETA DE INFORMACIÓN */
        #info-card {
            position: fixed;
            bottom: -150px; /* Escondida */
            left: 50%;
            transform: translateX(-50%);
            width: 85%;
            max-width: 400px;
            background: rgba(255, 255, 255, 0.98);
            padding: 20px;
            border-radius: 20px 20px 0 0;
            transition: bottom 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 999;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            box-shadow: 0 -5px 25px rgba(0,0,0,0.4);
        }

        #info-card.active { bottom: 0; }

        .close-btn { 
            float: right; 
            color: #777; 
            font-size: 20px; 
            font-weight: bold; 
            cursor: pointer; 
            padding: 5px;
        }

        h3 { margin-top: 0; color: #333; }
        p { color: #555; line-height: 1.4; }
    </style>
</head>

<body>
    <div id="loading-overlay">
        <div class="spinner"></div>
        <h2>ADIRIS Museo AR</h2>
        <p id="loading-status">Inicializando cámara...</p>
    </div>

    <div id="info-card">
        <span class="close-btn" onclick="closeInfo()">&times;</span>
        <h3 id="info-title">Título</h3>
        <p id="info-text">Descripción...</p>
    </div>

    <a-scene 
        mindar-image="imageTargetSrc: ./tu_cuadro.mind;" 
        color-space="sRGB" 
        renderer="colorManagement: true, physicallyCorrectLights" 
        vr-mode-ui="enabled: false" 
        device-orientation-permission-ui="enabled: false">
        
        <a-camera position="0 0 0" look-controls="enabled: false" cursor="fuse: false; rayOrigin: mouse;" raycaster="objects: .clickable"></a-camera>

        <a-entity mindar-image-target="targetIndex: 0">
            
            <a-circle 
                class="clickable"
                position="-0.2 0.2 0.1" 
                radius="0.06" 
                color="#FFD700"
                animation="property: scale; to: 1.2 1.2 1.2; dir: alternate; dur: 1000; loop: true"
                onclick="showInfo('El Rostro', 'Este detalle muestra la técnica de claroscuro utilizada por el autor para resaltar la expresión de paz.')">
            </a-circle>

            <a-circle 
                class="clickable"
                position="0.3 -0.2 0.1" 
                radius="0.06" 
                color="#00FFCC"
                animation="property: scale; to: 1.2 1.2 1.2; dir: alternate; dur: 1000; loop: true"
                onclick="showInfo('El Paisaje', 'El fondo representa las colinas de la Toscana, pintadas con pigmentos traídos de oriente.')">
            </a-circle>

        </a-entity>
    </a-scene>

    <script>
        // LÓGICA DE LA UI
        const card = document.getElementById('info-card');
        const title = document.getElementById('info-title');
        const text = document.getElementById('info-text');
        const overlay = document.getElementById('loading-overlay');
        const statusText = document.getElementById('loading-status');

        function showInfo(t, m) {
            title.innerText = t;
            text.innerText = m;
            card.classList.add('active');
        }

        function closeInfo() {
            card.classList.remove('active');
        }

        // LÓGICA DE CARGA DE AR.JS / MINDAR
        document.addEventListener("DOMContentLoaded", () => {
            const sceneEl = document.querySelector('a-scene');

            // Cuando la escena y la cámara están listas
            sceneEl.addEventListener("arReady", (event) => {
                overlay.classList.add('hidden');
            });

            // Si hay un error (ej: usuario niega la cámara)
            sceneEl.addEventListener("arError", (event) => {
                statusText.innerText = "Error: Acceso a la cámara denegado.";
                statusText.style.color = "#ff4444";
            });
        });
    </script>
</body>
</html>